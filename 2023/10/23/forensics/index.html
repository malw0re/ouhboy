<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Hacktheboo 2023 CTF | Malw0re</title><meta name="author" content="Malw0re"><meta name="copyright" content="Malw0re"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Challenges Writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="Hacktheboo 2023 CTF">
<meta property="og:url" content="https://malw0re.github.io/malwore.github.io/2023/10/23/forensics/index.html">
<meta property="og:site_name" content="Malw0re">
<meta property="og:description" content="Challenges Writeup">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://malw0re.github.io/malwore.github.io/images/qwe.png">
<meta property="article:published_time" content="2023-10-23T11:21:14.000Z">
<meta property="article:modified_time" content="2025-09-14T20:34:07.282Z">
<meta property="article:author" content="Malw0re">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://malw0re.github.io/malwore.github.io/images/qwe.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hacktheboo 2023 CTF",
  "url": "https://malw0re.github.io/malwore.github.io/2023/10/23/forensics/",
  "image": "https://malw0re.github.io/malwore.github.io/images/qwe.png",
  "datePublished": "2023-10-23T11:21:14.000Z",
  "dateModified": "2025-09-14T20:34:07.282Z",
  "author": [
    {
      "@type": "Person",
      "name": "Malw0re",
      "url": "https://malw0re.github.io/malwore.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/malwore.github.io/img/favicon.png"><link rel="canonical" href="https://malw0re.github.io/malwore.github.io/2023/10/23/forensics/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/malwore.github.io/css/index.css?v=5.5.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.0.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/malwore.github.io/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hacktheboo 2023 CTF',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/malwore.github.io/images/qwe.png" onerror="this.onerror=null;this.src='/malwore.github.io/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/malwore.github.io/archives/"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/malwore.github.io/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/malwore.github.io/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/malwore.github.io/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/categories/writeups/"><i class="fa-fw fas fa-folder-open"></i><span> Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/categories/research/"><i class="fa-fw fas fa-folder-open"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/malwore.github.io/images/cyberpunk-red.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/malwore.github.io/"><span class="site-name">Malw0re</span></a><a class="nav-page-title" href="/malwore.github.io/"><span class="site-name">Hacktheboo 2023 CTF</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/malwore.github.io/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/categories/writeups/"><i class="fa-fw fas fa-folder-open"></i><span> Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/categories/research/"><i class="fa-fw fas fa-folder-open"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/malwore.github.io/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Hacktheboo 2023 CTF</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-10-23T11:21:14.000Z" title="Created 2023-10-23 14:21:14">2023-10-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-09-14T20:34:07.282Z" title="Updated 2025-09-14 23:34:07">2025-09-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/malwore.github.io/categories/writeups/">writeups</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="https://i.imgur.com/GMsEYt3.png"></p>
<p>Hi 👋, in this article i’ll be sharing some challenges from the hacktheboo ctf challenges that was up i covered 3 challenges didn’t touch on the rest that much. So for the first bat challenge it was under the practice section and the last two are forensics which i decided to work on they were interesting. </p>
<p>Hope you have a nice read 😅</p>
<h2 id="Bat-Problems"><a href="#Bat-Problems" class="headerlink" title="Bat Problems"></a>Bat Problems</h2><h3 id="Explanation"><a href="#Explanation" class="headerlink" title="Explanation"></a>Explanation</h3><p>We are given the following file:</p>
<ul>
<li><code>payload.bat</code>: Malicious bat file.</li>
</ul>
<p>As we can see from the following image, the bat script contains many random variables that are assigned random values. In a batch script (a .bat or .cmd file), the set command defines and manipulates environment variables which store information that can be used by the script or other programs running in the same environment (the Command Prompt session).</p>
<p><img src="https://i.imgur.com/6Ila1bK.png"></p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>First, the bat file can be analyzed using <code>Any.Run</code> which is a malware analyzer tool.<br>We will get the following result if we upload the sample on the aforementioned site.</p>
<p><img src="https://i.imgur.com/qHgSgit.png"></p>
<p>By analyzing the behavior graph, we notice three actions made:</p>
<ol>
<li>The attacker can be seen using <code>cmd</code> to copy PowerShell to a different path with a random name (Earttxmxaqr.png). </li>
<li>The attacker then uses cmd again to rename the downloaded bat file and also change it’s extension to <code>.png.bat</code> to avoid detection.</li>
<li>The attacker executes the base64 encoded string using the renamed PowerShell executable (<code>-enc</code> argument in Powershell is used to pass a base64 encoded command).</li>
</ol>
<p><img src="https://i.imgur.com/TnYjjwM.png"></p>
<p>By decoding the string, the flag can be retrieved.</p>
<p><img src="https://i.imgur.com/yXGbDwO.png"></p>
<h2 id="Trick-or-Treat"><a href="#Trick-or-Treat" class="headerlink" title="Trick or Treat"></a>Trick or Treat</h2><h3 id="Explanation-1"><a href="#Explanation-1" class="headerlink" title="Explanation"></a>Explanation</h3><p>We are given the following file:</p>
<ul>
<li><code>capture.pcap</code>: Packet capture file</li>
<li><code>trick_or_treat.lnk</code>: The malicious file</li>
</ul>
<p>Since the malicious file is provided by HTB, we can first gain additional information on it through <code>VirusTotal</code>, a famous OSINT website. After scanning, the file shows that it is indeed malicious and it connects to a malicious domain called <code>windowsliveupdater.com</code>. We also can notice that the file is connected to a few IP addresses, mainly <code>209.197.3.8</code> which is the malicious one.</p>
<p><img src="https://i.imgur.com/2D3e9x9.png"></p>
<p>Analyzing further, we can understand what kind of processes are executed by the malicious file and how it attacks a system.</p>
<p>As shown in the picture below, the malicious file seems to download malicious data from <code>http://windowsliveupdater.com</code> using a random User-Agent for HTTP requests to essentially mask its identity on the network. It then sets the downloaded data into a variable (<code>$vurnwos</code>) and processes the characters in pairs and converts them from hexadecimal representation to their actual characters. It then performs a bitwise XOR operation with <code>0x1d</code> on each character and the output is appended to the <code>$vurnwos</code> string. Finally, it executes the variable using <code>Invoke-Command</code>. It also attempts to execute an empty variable (<code>$asvods</code>).</p>
<p><img src="https://i.imgur.com/CCvPfrn.png"></p>
<p>After knowing what the malicious file does, the packet capture file can be analyzed using Wireshark to find the downloaded content. Since we know that the malicious file requested data from a website, we can filter <code>HTTP</code> packets only.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/ctf4.png"></p>
<p>Going through the HTTP packets, we find a packet that shows the victim sending a GET request to <code>http://windowsliveupdater.com</code>. Analyzing the <code>User-Agent</code>, we can see that it is one of the randomized user agents set in the malicious file.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/ctf5.png"></p>
<p>Now we know that that the IP address <code>77.74.198.52</code> is responsible for the malicious file execution, we can check its HTTP response. Notice that the HTTP response packet has a cleartext data that is truncated because it is too long for Wireshark. The data is our key to getting the flag and it must be extracted using the decoding method specified in the malicious file.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/ctf6.png"></p>
<p><img src="https://i.imgur.com/DcWJVAU.png"></p>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><p>Since we know that the downloable content is encoded in hex and also XOR’ed using this key <code>0x1d</code>, we can use <code>CyberChef</code> to extract the content.</p>
<p><img src="https://i.imgur.com/kk8AUa1.png"></p>
<h2 id="ValHalloween"><a href="#ValHalloween" class="headerlink" title="ValHalloween"></a>ValHalloween</h2><h3 id="Explanation-2"><a href="#Explanation-2" class="headerlink" title="Explanation"></a>Explanation</h3><p>We are given the following file:</p>
<ul>
<li><code>Logs</code>: Directory containing various Windows XML EventLog (.evtx) files</li>
</ul>
<p>In this challenge, we are given a series of questions that must be answered to obtain the flag. These answers can all be located in certain event log files provided by HTB.</p>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><ol>
<li>What are the IP address and port of the server from which the malicious actors downloaded the ransomware? (for example: 98.76.54.32:443)</li>
</ol>
<ul>
<li>Answer: <code>103.162.14.116:8888</code></li>
</ul>
<p>To complete this question, we can analyze the <code>Security</code> log file and filter the logs with event ID 4688 which is normally logged in Event Viewer when a new process is created. After filtering the results, we find a Powershell script that was executed to download the ransomware (‘mscalc.exe’) from a malicious server with its IP address and port. Additionally, we now know the estimated time of the ransomware attack is around 11:03:24 AM on 20&#x2F;9&#x2F;2023.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win2.png"></p>
<ol start="2">
<li>According to the sysmon logs, what is the MD5 hash of the ransomware? (for example: 6ab0e507bcc2fad463959aa8be2d782f)</li>
</ol>
<ul>
<li>Answer: <code>B94F3FF666D9781CB69088658CD53772</code></li>
</ul>
<p>To complete this question, we can analyze the <code>sysmon</code> log file and filter the logs with event ID 1 which is normally logged in Event Viewer when a new process is created. After filtering the results and since we know the Powershell script downloads the ransomware, we can attempt to find its child processes to locate the creation process of the ransomware. After analyzing the logs, we can find the ransomware with its MD5 hash.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win3.png"></p>
<ol start="3">
<li>Based on the hash found, determine the family label of the ransomware in the wild from online reports such as Virus Total, Hybrid Analysis, etc. (for example: wannacry)</li>
</ol>
<ul>
<li>Answer: <code>lokilocker</code></li>
</ul>
<p>To complete this question, just put the ransomware’s MD5 hash to any OSINT tool and check its family labels.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win4.png"></p>
<ol start="4">
<li>What is the name of the task scheduled by the ransomware? (for example: WindowsUpdater)</li>
</ol>
<ul>
<li>Answer: <code>Loki</code></li>
</ul>
<p>To complete this question, we can analyze the <code>sysmon</code> log file and filter the logs with keyword ‘schtasks’ which is the name for task scheduling process. After filtering the results, we find a schtasks program with the parent process being the ransomware.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win5.png"></p>
<ol start="5">
<li>What are the parent process name and ID of the ransomware process? (for example: svchost.exe_4953)</li>
</ol>
<ul>
<li>Answer: <code>powershell.exe_3856</code></li>
</ul>
<p>To complete this question, we can analyze the <code>sysmon</code> log file and check the ransomware process again. Viewing the XML format of the ransomware process, we can easily find the parent process name and ID of the ransomware process.</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win6.png"></p>
<ol start="6">
<li>Following the PPID, provide the file path of the initial stage in the infection chain. (for example: D:\Data\KCorp\FirstStage.pdf)</li>
</ol>
<ul>
<li>Answer: <code>C:\Users\HoaGay\Documents\Subjects\Unexpe.docx</code></li>
</ul>
<p>To complete this question, we can analyze the <code>Security</code> log file again and check the Powershell script process again. As the question suggests, we can use the PPID to retrace the steps to the initial stage in the infection chain. As shown in the pictures below, we then stumble upon a malicious <code>.docx</code> file</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win7.png"></p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win8.png"></p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win9.png"></p>
<ol start="7">
<li>When was the first file in the infection chain opened (in UTC)? (for example: 1975-04-30_12:34:56)</li>
</ol>
<ul>
<li>Answer: <code>2023-09-20_03:03:20</code></li>
</ul>
<p>To complete this question, we can just view the XML format of the <code>.docx</code> file and find the <code>TimeCreated SystemTime</code> row. ENSURE THE TIME FORMAT IS IN UTC!</p>
<p><img src="https://github.com/warlocksmurf/hacktheboo2023-ctf/raw/main/images/win10.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://malw0re.github.io/malwore.github.io">Malw0re</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://malw0re.github.io/malwore.github.io/2023/10/23/forensics/">https://malw0re.github.io/malwore.github.io/2023/10/23/forensics/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/malwore.github.io/tags/ctf/">ctf</a></div><div class="post-share"><div class="social-share" data-image="/malwore.github.io/images/qwe.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/malwore.github.io/2023/10/13/insecure-rdp/" title="INSECURE RDP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">INSECURE RDP</div></div><div class="info-2"><div class="info-item-1">Objective:  Exploit the application and retrieve the flag! EnumerationRunning nmap on our target, we see there’s a distinct port 3333 with a very peculiar service dec-notes. Our focus primarily will be exploiting the insecure rdp service.  MetasploitTo confirm if the target is running rdp we’ll use a metasploit module called rdp-scanner what it does is it attempts to connect to the specified RDP port and determines if it “speaks” RDP.  Setting up the required variables for the module, we get ...</div></div></div></a><a class="pagination-related" href="/malwore.github.io/2023/11/20/hospital-notes/" title="Hospital"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Hospital</div></div><div class="info-2"><div class="info-item-1"> IntroHospital. It is a Medium Category Machine. It involves some File Upload Attack, Ghostscript Command Injection and some Windows Privesc Initial Recon123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129PORT     STATE SERVICE          REASON22/tcp   open  ssh        ...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/malwore.github.io/images/qwe.png" onerror="this.onerror=null;this.src='/malwore.github.io/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Malw0re</div><div class="author-info-description"></div><div class="site-data"><a href="/malwore.github.io/archives/"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/malwore.github.io/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/malwore.github.io/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/malw0re/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/malw0re/" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/brian-karanja-21331b164/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.x.com/M4LW0R3" target="_blank" title="twitter"><i class="fab fa-twitter" style="color: #cd486b;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my blog  where I post my writeups from Boxes & CTFs along with exploit research!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Bat-Problems"><span class="toc-number">1.</span> <span class="toc-text">Bat Problems</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Explanation"><span class="toc-number">1.1.</span> <span class="toc-text">Explanation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution"><span class="toc-number">1.2.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trick-or-Treat"><span class="toc-number">2.</span> <span class="toc-text">Trick or Treat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Explanation-1"><span class="toc-number">2.1.</span> <span class="toc-text">Explanation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1"><span class="toc-number">2.2.</span> <span class="toc-text">Solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ValHalloween"><span class="toc-number">3.</span> <span class="toc-text">ValHalloween</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Explanation-2"><span class="toc-number">3.1.</span> <span class="toc-text">Explanation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2"><span class="toc-number">3.2.</span> <span class="toc-text">Solution</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/malwore.github.io/2024/02/29/monitored/" title="Monitored"><img src="/malwore.github.io/images/monitored.webp" onerror="this.onerror=null;this.src='/malwore.github.io/img/404.jpg'" alt="Monitored"/></a><div class="content"><a class="title" href="/malwore.github.io/2024/02/29/monitored/" title="Monitored">Monitored</a><time datetime="2024-02-29T08:30:03.000Z" title="Created 2024-02-29 11:30:03">2024-02-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/malwore.github.io/2024/01/04/acls/" title="ACL AD">ACL AD</a><time datetime="2024-01-03T21:00:00.000Z" title="Created 2024-01-04 00:00:00">2024-01-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/malwore.github.io/2023/11/29/stealth/" title="stealth">stealth</a><time datetime="2023-11-29T08:30:03.000Z" title="Created 2023-11-29 11:30:03">2023-11-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/malwore.github.io/2023/11/20/hospital-notes/" title="Hospital">Hospital</a><time datetime="2023-11-20T08:30:03.000Z" title="Created 2023-11-20 11:30:03">2023-11-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/malwore.github.io/2023/10/23/forensics/" title="Hacktheboo 2023 CTF">Hacktheboo 2023 CTF</a><time datetime="2023-10-23T11:21:14.000Z" title="Created 2023-10-23 14:21:14">2023-10-23</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2020 - 2025 By Malw0re</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/malwore.github.io/js/utils.js?v=5.5.0"></script><script src="/malwore.github.io/js/main.js?v=5.5.0"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/click-show-text.min.js" data-mobile="false" data-text="getsystem,ntsystem,sudo rm -rf,root,administrator,ctfs,sliver,cobalt strike,python,c#,malw0re,empire,( ͡° ͜ʖ ͡°)" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>