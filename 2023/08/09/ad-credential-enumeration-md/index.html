<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>AD CRED ENUM | ouhboy</title><meta name="author" content="malw0re"><meta name="copyright" content="malw0re"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Active Directory credential enumeration">
<meta property="og:type" content="article">
<meta property="og:title" content="AD CRED ENUM">
<meta property="og:url" content="https://malw0re.github.io/ouhboy/2023/08/09/ad-credential-enumeration-md/index.html">
<meta property="og:site_name" content="ouhboy">
<meta property="og:description" content="Active Directory credential enumeration">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://malw0re.github.io/ouhboy/images/darkbasin.jpg">
<meta property="article:published_time" content="2023-08-08T21:00:00.000Z">
<meta property="article:modified_time" content="2025-09-14T22:58:43.000Z">
<meta property="article:author" content="malw0re">
<meta property="article:tag" content="Active-Directory">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://malw0re.github.io/ouhboy/images/darkbasin.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "AD CRED ENUM",
  "url": "https://malw0re.github.io/ouhboy/2023/08/09/ad-credential-enumeration-md/",
  "image": "https://malw0re.github.io/ouhboy/images/darkbasin.jpg",
  "datePublished": "2023-08-08T21:00:00.000Z",
  "dateModified": "2025-09-14T22:58:43.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "malw0re",
      "url": "https://malw0re.github.io/ouhboy"
    }
  ]
}</script><link rel="shortcut icon" href="/ouhboy/img/favicon.png"><link rel="canonical" href="https://malw0re.github.io/ouhboy/2023/08/09/ad-credential-enumeration-md/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/ouhboy/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/ouhboy/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'AD CRED ENUM',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/ouhboy/images/cyber.png" onerror="this.onerror=null;this.src='/ouhboy/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/ouhboy/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/ouhboy/tags/"><div class="headline">Tags</div><div class="length-num">12</div></a><a href="/ouhboy/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/ouhboy/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/categories/writeups/"><i class="fa-fw fas fa-archive"></i><span> Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/categories/research/"><i class="fa-fw fas fa-flask"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/ouhboy/images/cyberpunk-red.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/ouhboy/"><span class="site-name">ouhboy</span></a><a class="nav-page-title" href="/ouhboy/"><span class="site-name">AD CRED ENUM</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/ouhboy/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/categories/writeups/"><i class="fa-fw fas fa-archive"></i><span> Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/categories/research/"><i class="fa-fw fas fa-flask"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/ouhboy/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">AD CRED ENUM</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-08-08T21:00:00.000Z" title="Created 2023-08-09 00:00:00">2023-08-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-09-14T22:58:43.000Z" title="Updated 2025-09-15 01:58:43">2025-09-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/ouhboy/categories/research/">research</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="https://miro.medium.com/v2/resize:fit:750/0*Kz1iA9w7Ciywdu1A.jpg"></p>
<h2 id="Credential-Enumeration"><a href="#Credential-Enumeration" class="headerlink" title="Credential Enumeration"></a>Credential Enumeration</h2><p>After acquiring a foothold, you must dig deeper using the low-privilege domain user credentials. Information to be interested in when enumerating:</p>
<ul>
<li>Domain users</li>
<li>Computer Attributes</li>
<li>group membership</li>
<li>Group Policy Objects</li>
<li>Permissions</li>
<li>ACLs</li>
<li>Trusts</li>
</ul>
<p>Most of these tools will not work without domain users’ credentials at any permission level. So at a minimum, you need to have acquired a user’s cleartext password, NTLM password hash or SYSTEM access on a domain-joined host.</p>
<h2 id="CrackMapExec"><a href="#CrackMapExec" class="headerlink" title="CrackMapExec"></a>CrackMapExec</h2><p>This tool can be used to assess AD environments, where it utilizes packages from the impacket and powersploit toolkit to perform its functions.</p>
<h3 id="Domain-UserEnum"><a href="#Domain-UserEnum" class="headerlink" title="Domain UserEnum"></a>Domain UserEnum</h3><p>When enumerating you need to point CME to the Domain Controller. CME provides a <strong>badPwdCount</strong> attribute which is helpful when performing targeted pass spraying to avoid locking out accounts.</p>
<p><code>sudo crackmapexec smb xx-domain-ip-xx -u xxxxxxxx -p xxxxx --users</code></p>
<h3 id="Domain-Group-Enum"><a href="#Domain-Group-Enum" class="headerlink" title="Domain Group Enum"></a>Domain Group Enum</h3><p>We can obtain a complete listing of domain groups. Take note of key groups like <code>Administrators</code>, <code>Domain Admins</code>, and <code>Executives</code>.</p>
<p><code>sudo crackmapexec smb xx-domain-ip-xx -u xxxxxxxx -p xxxxx --groups</code></p>
<h2 id="Smbmap"><a href="#Smbmap" class="headerlink" title="Smbmap"></a>Smbmap</h2><p>A tool for enumerating SMB shares from a Linux environment to list shares, permissions, and content.</p>
<h3 id="recursive-list-Dirs-in-Shares"><a href="#recursive-list-Dirs-in-Shares" class="headerlink" title="recursive list Dirs in Shares"></a>recursive list Dirs in Shares</h3><p><code>smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5 -R &#39;Department Shares&#39; --dir-only</code></p>
<h2 id="RpcClient"><a href="#RpcClient" class="headerlink" title="RpcClient"></a>RpcClient</h2><p>Used to enumerate, add, change and even remove objects from AD.</p>
<h3 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h3><p>A Relative Identifier (RID) is combined with a SID to make a unique value representing an object. Built-in admin accounts for domains will typically have a RID of <strong>500</strong> or <strong>0x1f4</strong>.</p>
<h2 id="Impacket-Toolkit"><a href="#Impacket-Toolkit" class="headerlink" title="Impacket-Toolkit"></a>Impacket-Toolkit</h2><p>A versatile toolkit used to interact with and exploit Windows protocols using Python.</p>
<h3 id="Psexec-py"><a href="#Psexec-py" class="headerlink" title="Psexec.py"></a>Psexec.py</h3><p>Provides a shell as SYSTEM on the victim host by creating a remote service via RPC.</p>
<h3 id="windapsearch"><a href="#windapsearch" class="headerlink" title="windapsearch"></a>windapsearch</h3><p>A Python script to enumerate users, groups, and computers utilizing LDAP queries.</p>
<p><code>python3 windapsearch.py --dc-ip 172.16.5.5 -u forend@inlanefreight.local -p Klmcargo2 --da</code></p>
<h2 id="BloodHound"><a href="#BloodHound" class="headerlink" title="BloodHound"></a>BloodHound</h2><p>An auditing tool that creates a GUI representation of “attack paths” within Active Directory.</p>
<h2 id="ActiveDirectory-Powershell-Modules"><a href="#ActiveDirectory-Powershell-Modules" class="headerlink" title="ActiveDirectory Powershell Modules"></a>ActiveDirectory Powershell Modules</h2><p>Cmdlets used for enumerating AD environments.</p>
<ul>
<li><code>Get-ADDomain</code>: Prints domain SID and functional level.</li>
<li><code>Get-ADTrust -Filter *</code>: Prints domain trust relationships.</li>
<li><code>Get-ADGroupMember -Identity &quot;Backup Operators&quot;</code>: Lists group membership.</li>
</ul>
<h2 id="Powerview"><a href="#Powerview" class="headerlink" title="Powerview"></a>Powerview</h2><p>Identifies where users are logged in and hunts for file shares, passwords, and ACLs.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Get-DomainUser</td>
<td>Returns all users or specific user objects</td>
</tr>
<tr>
<td>Get-DomainGroupMember</td>
<td>Returns members of a specific domain group</td>
</tr>
<tr>
<td>Find-LocalAdminAccess</td>
<td>Finds machines where current user has admin access</td>
</tr>
<tr>
<td>Get-DomainTrust</td>
<td>Returns domain trusts</td>
</tr>
</tbody></table>
<h2 id="Shares"><a href="#Shares" class="headerlink" title="Shares"></a>Shares</h2><h3 id="Snaffler"><a href="#Snaffler" class="headerlink" title="Snaffler"></a>Snaffler</h3><p>Works by obtaining a list of hosts and enumerating shares for sensitive data or credentials.</p>
<h2 id="Living-off-the-Land"><a href="#Living-off-the-Land" class="headerlink" title="Living off the Land"></a>Living off the Land</h2><p>Using native Windows tools is a stealthy approach that creates fewer log entries for defenders to detect.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Result</th>
</tr>
</thead>
<tbody><tr>
<td>hostname</td>
<td>Prints the PC’s Name</td>
</tr>
<tr>
<td>ipconfig &#x2F;all</td>
<td>Prints out network configurations</td>
</tr>
<tr>
<td>set %logonserver%</td>
<td>Prints name of the Domain controller</td>
</tr>
</tbody></table>
<h2 id="OPSec-Tactics"><a href="#OPSec-Tactics" class="headerlink" title="OPSec Tactics"></a>OPSec Tactics</h2><p>Defender visibility can be avoided by calling PowerShell version 2.0 or older, as event logging was introduced in version 3.0.</p>
<h3 id="Checking-Defenses"><a href="#Checking-Defenses" class="headerlink" title="Checking Defenses"></a>Checking Defenses</h3><ul>
<li>Firewall check: <code>netsh advfirewall show allprofiles</code></li>
<li>Defender check: <code>sc query windefend</code></li>
</ul>
<h2 id="WMI-Windows-Management-Instrumentation"><a href="#WMI-Windows-Management-Instrumentation" class="headerlink" title="WMI (Windows Management Instrumentation)"></a>WMI (Windows Management Instrumentation)</h2><p>A scripting engine used to retrieve info and run admin tasks.</p>
<p><code>wmic qfe get Caption,Description,HotFixID,InstalledOn</code></p>
<h2 id="Net-Commands"><a href="#Net-Commands" class="headerlink" title="Net Commands"></a>Net Commands</h2><p>Useful for querying the localhost and remote hosts.</p>
<p><code>net group &quot;Domain Admins&quot; /domain</code></p>
<p><strong>Tip:</strong> Use <code>net1</code> instead of <code>net</code> to potentially bypass basic command monitoring.</p>
<h2 id="Dsquery"><a href="#Dsquery" class="headerlink" title="Dsquery"></a>Dsquery</h2><p>A command-line tool found at <code>C:\Windows\System32\dsquery.dll</code> used to find AD objects.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://malw0re.github.io/ouhboy">malw0re</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://malw0re.github.io/ouhboy/2023/08/09/ad-credential-enumeration-md/">https://malw0re.github.io/ouhboy/2023/08/09/ad-credential-enumeration-md/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/ouhboy/tags/Active-Directory/">Active-Directory</a></div><div class="post-share"><div class="social-share" data-image="/ouhboy/images/darkbasin.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/ouhboy/2023/09/15/metasploit-ctf-1-md/" title="MSF CTF"><img class="cover" src="https://malw0re.github.io/ouhboy/images/msf.jpg" onerror="onerror=null;src='/ouhboy/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">MSF CTF</div></div><div class="info-2"><div class="info-item-1">Metasploit ctf I (easy)CTF Scenario: This lab is dedicated to you! No other users are on this network :) Once you start the lab, you will have access to a Kali terminal based instance. This machine has an interface with IP address 192.X.Y.Z. The lab has two target machines which should be located on the same subnet i.e. 192.X.Y.0&#x2F;24 The target systems most of times, belong to “admin” or “root” user. Do not attack the gateway located at IP address 192.X.Y.1 You can use all tools installed...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/ouhboy/2024/07/13/kerberos-101/" title="Kerberos"><img class="cover" src="/ouhboy/images/kerb.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-13</div><div class="info-item-2">Kerberos</div></div><div class="info-2"><div class="info-item-1">KerberoastingThe Kerberos protocol defines how clients interact with a network authentication service, clients obtain tickets from the Kerberos Key Distribution Center (KDC) and they submit these tickets to application servers when connections are established. uses port 88 by default and depends on the process of symmetric key cryptography. NB [kerberos uses tickets to authenticate a user and completely avoids sending passwords across the network]  How Kerb Auth works!In every Active Director...</div></div></div></a><a class="pagination-related" href="/ouhboy/2024/01/04/acls/" title="ACL AD"><img class="cover" src="/ouhboy/images/access.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-04</div><div class="info-item-2">ACL AD</div></div><div class="info-2"><div class="info-item-1">Active Directory ACLsAccess Control Lists (ACLs) define the permissions for objects within Active Directory. Key Concepts ACE (Access Control Entry): An individual permission entry within an ACL. DACL (Discretionary ACL): Defines who has what access to an object. SACL (System ACL): Used for auditing access attempts.  Security RisksMisconfigured ACLs can lead to privilege escalation, such as “GenericAll” or “WriteDacl” permissions granted to low-privilege users. </div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/ouhboy/images/cyber.png" onerror="this.onerror=null;this.src='/ouhboy/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">malw0re</div><div class="author-info-description">Cybersecurity, CTFs</div><div class="site-data"><a href="/ouhboy/archives/"><div class="headline">Articles</div><div class="length-num">9</div></a><a href="/ouhboy/tags/"><div class="headline">Tags</div><div class="length-num">12</div></a><a href="/ouhboy/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/malw0re"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/MALW0RE" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/karanja-brian/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.x.com/M4LW0R3" target="_blank" title="Instagram"><i class="fab fa-twitter" style="color: #cd486b;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my blog where I post my writeups from Boxes & CTFs along with exploit research!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Credential-Enumeration"><span class="toc-number">1.</span> <span class="toc-text">Credential Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CrackMapExec"><span class="toc-number">2.</span> <span class="toc-text">CrackMapExec</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Domain-UserEnum"><span class="toc-number">2.1.</span> <span class="toc-text">Domain UserEnum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Domain-Group-Enum"><span class="toc-number">2.2.</span> <span class="toc-text">Domain Group Enum</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Smbmap"><span class="toc-number">3.</span> <span class="toc-text">Smbmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#recursive-list-Dirs-in-Shares"><span class="toc-number">3.1.</span> <span class="toc-text">recursive list Dirs in Shares</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RpcClient"><span class="toc-number">4.</span> <span class="toc-text">RpcClient</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Enumeration"><span class="toc-number">4.1.</span> <span class="toc-text">Enumeration</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Impacket-Toolkit"><span class="toc-number">5.</span> <span class="toc-text">Impacket-Toolkit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Psexec-py"><span class="toc-number">5.1.</span> <span class="toc-text">Psexec.py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windapsearch"><span class="toc-number">5.2.</span> <span class="toc-text">windapsearch</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BloodHound"><span class="toc-number">6.</span> <span class="toc-text">BloodHound</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ActiveDirectory-Powershell-Modules"><span class="toc-number">7.</span> <span class="toc-text">ActiveDirectory Powershell Modules</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Powerview"><span class="toc-number">8.</span> <span class="toc-text">Powerview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shares"><span class="toc-number">9.</span> <span class="toc-text">Shares</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Snaffler"><span class="toc-number">9.1.</span> <span class="toc-text">Snaffler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Living-off-the-Land"><span class="toc-number">10.</span> <span class="toc-text">Living off the Land</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OPSec-Tactics"><span class="toc-number">11.</span> <span class="toc-text">OPSec Tactics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Checking-Defenses"><span class="toc-number">11.1.</span> <span class="toc-text">Checking Defenses</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WMI-Windows-Management-Instrumentation"><span class="toc-number">12.</span> <span class="toc-text">WMI (Windows Management Instrumentation)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Net-Commands"><span class="toc-number">13.</span> <span class="toc-text">Net Commands</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dsquery"><span class="toc-number">14.</span> <span class="toc-text">Dsquery</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/ouhboy/2026/02/01/Facts/" title="Facts HTB Writeup"><img src="/ouhboy/images/facts.webp" onerror="this.onerror=null;this.src='/ouhboy/img/404.jpg'" alt="Facts HTB Writeup"/></a><div class="content"><a class="title" href="/ouhboy/2026/02/01/Facts/" title="Facts HTB Writeup">Facts HTB Writeup</a><time datetime="2026-01-31T23:38:46.000Z" title="Created 2026-02-01 02:38:46">2026-02-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ouhboy/2026/01/18/Azure/" title="Azure Security"><img src="/ouhboy/images/azure.jpeg" onerror="this.onerror=null;this.src='/ouhboy/img/404.jpg'" alt="Azure Security"/></a><div class="content"><a class="title" href="/ouhboy/2026/01/18/Azure/" title="Azure Security">Azure Security</a><time datetime="2026-01-18T09:44:04.000Z" title="Created 2026-01-18 12:44:04">2026-01-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ouhboy/2026/01/11/Aws/" title="AWS Security"><img src="/ouhboy/images/aws.png" onerror="this.onerror=null;this.src='/ouhboy/img/404.jpg'" alt="AWS Security"/></a><div class="content"><a class="title" href="/ouhboy/2026/01/11/Aws/" title="AWS Security">AWS Security</a><time datetime="2026-01-11T09:44:04.000Z" title="Created 2026-01-11 12:44:04">2026-01-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ouhboy/2024/07/13/kerberos-101/" title="Kerberos"><img src="/ouhboy/images/kerb.webp" onerror="this.onerror=null;this.src='/ouhboy/img/404.jpg'" alt="Kerberos"/></a><div class="content"><a class="title" href="/ouhboy/2024/07/13/kerberos-101/" title="Kerberos">Kerberos</a><time datetime="2024-07-12T21:00:00.000Z" title="Created 2024-07-13 00:00:00">2024-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ouhboy/2024/01/04/acls/" title="ACL AD"><img src="/ouhboy/images/access.jpg" onerror="this.onerror=null;this.src='/ouhboy/img/404.jpg'" alt="ACL AD"/></a><div class="content"><a class="title" href="/ouhboy/2024/01/04/acls/" title="ACL AD">ACL AD</a><time datetime="2024-01-03T21:00:00.000Z" title="Created 2024-01-04 00:00:00">2024-01-04</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;Since 100 BC - 2026 By malw0re</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/ouhboy/js/utils.js?v=5.5.3"></script><script src="/ouhboy/js/main.js?v=5.5.3"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/click-show-text.min.js" data-mobile="false" data-text="getsystem,sudo rm -rf,root,administrator,havoc,sliver,cobalt strike,python,c#,daz,empire,( ͡° ͜ʖ ͡°)" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>